function DromDropDown(config){var options={selector:'[data-toggle="dropdown"]',position:"auto",customTarget:false,customContainer:false,autoPositionOnResize:true,activeClass:false,beforeOpen:false,beforeClose:false,forceBeforeOpenReposition:false,overlay:false,animated:false,animationFade:true,animationType:false,animationDuration:.3},$buttons=null,arAnimatedBlocks=[],that=this;this.options=$.extend({},options,config);this.cssAnimationProps={overflow:"hidden",height:"auto",opacity:1};if(!this.options.animationFade){delete this.cssAnimationProps.opacity}this.currentTab={button:false,dialogWindow:false,container:false};var _fn_dropdown=this._dropdown.bind(this);if(this.options.animated){$(this.options.selector).each(function(){var $el=$(this),target=$el.attr("data-target"),$customContainer=$el.closest(that.options.customContainer),$hiddenContent=$customContainer.find('[data-target-bind="'+target+'"]'),hiddenItemHeight;arAnimatedBlocks.push($hiddenContent);that.cssAnimationProps.height="auto";$hiddenContent.css(that.cssAnimationProps);hiddenItemHeight=$hiddenContent.outerHeight(false);if($hiddenContent.attr("target-status")==="open"){$el.addClass($el.attr("class").split(" ")[0]+"_active");that.currentTab.button=$el;that.currentTab.dilogWindow=$hiddenContent;$hiddenContent.css(that.cssAnimationProps).attr("data-height",hiddenItemHeight)}else{that.cssAnimationProps.height=0;$hiddenContent.css(that.cssAnimationProps).attr("data-height",hiddenItemHeight)}that._setAnimation($hiddenContent,that.options.animationType,that.options.animationDuration)});$(window).on("resize orientationchange load",function(){arAnimatedBlocks.forEach(function($block){$block.addClass("js-disable-transition");var blockWidth=$block.outerWidth(false);$block.css({width:blockWidth,height:"auto",position:"absolute"});var blockHeight=$block.outerHeight(false);$block.attr("data-height",blockHeight);$block.css({width:"auto",position:"static"});if(!$block.attr("target-status")||$block.attr("target-status")==="close"){$block.css({height:0})}$block.removeClass("js-disable-transition")})})}$(this.options.selector).each(function(index,value){$(this).bind("click.dn",_fn_dropdown)});return this}DromDropDown.prototype={_setAnimation:function(DOMElement,animationType,animationDuration){if(!animationType){this.cssAnimationProps["-webkit-transition"]="all .3s cubic-bezier(0.25,0.1,0.25,1)";this.cssAnimationProps.transition="all .3s cubic-bezier(0.25,0.1,0.25,1)";DOMElement.css(this.cssAnimationProps)}else{this.cssAnimationProps["-webkit-transition"]="all "+animationDuration+"s cubic-bezier("+animationType+")";this.cssAnimationProps.transition="all "+animationDuration+"s cubic-bezier("+animationType+")";DOMElement.css(this.cssAnimationProps)}},_removeAnimation:function(DOMElement){delete this.cssAnimationProps["-webkit-transition"];delete this.cssAnimationProps.transition;DOMElement.css(this.cssAnimationProps)},reposition:function(){if(this.options.position!=="auto"){return}var buttonPositions=this.currentTab.button.position(),btnOffset=this.currentTab.button.offset(),offset=this.currentTab.container.offset().left,height;if(this.currentTab.button.outerWidth()>this.currentTab.dialogWindow.outerWidth()){this.currentTab.dialogWindow.css("width",this.currentTab.button.outerWidth()+50)}this.currentTab.dialogWindow.css({top:buttonPositions.top+this.currentTab.button.outerHeight(false)-1});if($("html").hasClass("drom-mobile")){this.currentTab.dialogWindow.css({left:-btnOffset.left})}else if(Math.abs(offset-btnOffset.left)+this.currentTab.dialogWindow.outerWidth()>this.currentTab.container.outerWidth()){this.currentTab.dialogWindow.css({left:buttonPositions.left+this.currentTab.button.outerWidth()-this.currentTab.dialogWindow.outerWidth()})}else{this.currentTab.dialogWindow.css({left:buttonPositions.left})}},_dropdown:function(e){e.preventDefault();e.stopPropagation();var $button=$(e.currentTarget),value=$button.attr("data-target"),position=$button.attr("data-position")?$button.attr("data-position"):this.options.position,buttonActiveClass=$button.attr("class").split(" ")[0]+"_active",$container=this.options.customContainer?$button.closest(this.options.customContainer):$button.closest($button.attr("data-target-container")),$hiddenBlock=this.options.customTarget?$(this.options.customTarget).first():$container.find('[data-target-bind="'+value+'"] '),$openedBlock=this.options.customTarget?$container.find('[target-status="open"]'):$container.find('[target-status="open"]'),openCaption=$button.attr("data-open-caption"),closedCaption=$button.attr("data-closed-caption"),$captionHolder=$button.find("[data-caption]"),overlay=$("[overlay]"),that=this;this.currentTab.button=$button;this.currentTab.dialogWindow=$hiddenBlock;this.currentTab.container=$container;if($container&&$container.length>0){if(overlay.length<1&&this.options.overlay){overlay=document.createElement("div");overlay.className="b-overlay-fixed";overlay.setAttribute("overlay","true");overlay.addEventListener("click",function(){$button.parent().find('[target-status="open"]').removeAttr("style").attr("target-status","close");$container.find("."+buttonActiveClass).removeClass(buttonActiveClass);$("[overlay]").remove()});document.querySelector("body").appendChild(overlay)}if(!$button.hasClass(buttonActiveClass)){if(openCaption&&closedCaption&&$captionHolder.length){$captionHolder.text(openCaption)}if(this.options.forceBeforeOpenReposition){this.reposition()}if(typeof this.options.beforeOpen==="function"){this.options.beforeOpen.call(this,$button,$hiddenBlock)}$button.parent().find('[target-status="open"]');if($openedBlock.length>0){$container.find("."+buttonActiveClass).removeClass(buttonActiveClass);$(window).unbind("resize.trigger")}$button.addClass(buttonActiveClass);$hiddenBlock.attr("target-status","open");$openedBlock.attr("target-status","close");if(this.options.animated){this._removeAnimation($openedBlock);this.cssAnimationProps.height=$openedBlock.attr("data-height");$openedBlock.css(this.cssAnimationProps);setTimeout(function(){that.cssAnimationProps.height=$hiddenBlock.attr("data-height");if(that.options.animationFade){that.cssAnimationProps.opacity=1}that._setAnimation($openedBlock,that.options.animationType,that.options.animationDuration);$hiddenBlock.css(that.cssAnimationProps);that.cssAnimationProps.height=0;if(that.options.animationFade){that.cssAnimationProps.opacity=0}$openedBlock.css(that.cssAnimationProps)},1)}else{$hiddenBlock.css("display","block");$openedBlock.removeAttr("style")}if(position==="auto"){this.reposition();if(this.options.autoPositionOnResize){var _fn_reposition=this.reposition.bind(this);$(window).bind("resize.dn",_fn_reposition)}}}else{if(openCaption&&closedCaption&&$captionHolder.length){$captionHolder.text(closedCaption)}if(typeof this.options.beforeClose==="function"){this.options.beforeClose.call(this,$button,$openedBlock)}$button.removeClass(buttonActiveClass);$openedBlock.attr("target-status","close");if(this.options.animated){this._removeAnimation($openedBlock);this.cssAnimationProps.height=$openedBlock.attr("data-height");$openedBlock.css(this.cssAnimationProps);setTimeout(function(){that._setAnimation($openedBlock,that.options.animationType,that.options.animationDuration);that.cssAnimationProps.height=0;if(that.options.animationFade){that.cssAnimationProps.opacity=0}$openedBlock.css(that.cssAnimationProps)},1)}else{$openedBlock.removeAttr("style")}$(window).unbind("resize.dn");overlay.remove()}}}};
